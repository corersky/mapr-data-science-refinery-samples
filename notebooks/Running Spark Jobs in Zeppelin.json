{"paragraphs":[{"text":"%md\n## This section contains code sample for Apache Spark job that you can run in your Apache Zeppelin notebook. \nYou can run this example using either the Livy or Spark interpreter. \n\n[MapR Data Science Refinery Documentation](https://mapr.com/docs/61/Zeppelin/ZeppelinSpark.html)\n\n#### Pre-requisistes\n\nBefore running these examples, depending on whether you are using the [Livy](https://mapr.com/docs/61/Zeppelin/ConfigureLivyInterpreter.html#task_t1d_4yj_qbb) or [Spark](https://mapr.com/docs/61/Zeppelin/ConfigureSparkInterpreter.html#task_t1d_4yj_qbb) interpreter, make sure you have configured the interpreter.","user":"mapr","dateUpdated":"2019-04-25T10:28:18-0700","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>This section contains code sample for Apache Spark job that you can run in your Apache Zeppelin notebook.</h2>\n<p>You can run this example using either the Livy or Spark interpreter. </p>\n<p><a href=\"https://mapr.com/docs/61/Zeppelin/ZeppelinSpark.html\">MapR Data Science Refinery Documentation</a></p>\n<h4>Pre-requisistes</h4>\n<p>Before running these examples, depending on whether you are using the <a href=\"https://mapr.com/docs/61/Zeppelin/ConfigureLivyInterpreter.html#task_t1d_4yj_qbb\">Livy</a> or <a href=\"https://mapr.com/docs/61/Zeppelin/ConfigureSparkInterpreter.html#task_t1d_4yj_qbb\">Spark</a> interpreter, make sure you have configured the interpreter.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1556210522159_1297602954","id":"20150213-231621_168813393","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:18-0700","dateFinished":"2019-04-25T10:28:18-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14120"},{"title":"Load data into table","text":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\n\n// Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)\n// So you don't need create them manually\n\n// load bank data\nval bankText = sc.parallelize(\n    IOUtils.toString(\n        new URL(\"https://s3.amazonaws.com/apache-zeppelin/tutorial/bank/bank.csv\"),\n        Charset.forName(\"utf8\")).split(\"\\n\"))\n\ncase class Bank(age: Integer, job: String, marital: String, education: String, balance: Integer)\n\nval bank = bankText.map(s => s.split(\";\")).filter(s => s(0) != \"\\\"age\\\"\").map(\n    s => Bank(s(0).toInt, \n            s(1).replaceAll(\"\\\"\", \"\"),\n            s(2).replaceAll(\"\\\"\", \"\"),\n            s(3).replaceAll(\"\\\"\", \"\"),\n            s(5).replaceAll(\"\\\"\", \"\").toInt\n        )\n).toDF()\nbank.registerTempTable(\"bank\")","user":"mapr","dateUpdated":"2019-04-25T10:28:18-0700","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\nbankText: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[160] at parallelize at <console>:56\ndefined class Bank\nbank: org.apache.spark.sql.DataFrame = [age: int, job: string ... 3 more fields]\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1556210522160_9997221","id":"20150210-015259_1403135953","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:18-0700","dateFinished":"2019-04-25T10:28:21-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14121"},{"text":"%sql \nselect age, count(1) value\nfrom bank \nwhere age < 50 \ngroup by age \norder by age","user":"mapr","dateUpdated":"2019-04-25T10:28:27-0700","config":{"colWidth":4,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n19\t4\n20\t3\n21\t7\n22\t9\n23\t20\n24\t24\n25\t44\n26\t77\n27\t94\n28\t103\n29\t97\n30\t150\n31\t199\n32\t224\n33\t186\n34\t231\n35\t180\n36\t188\n37\t161\n38\t159\n39\t130\n40\t142\n41\t135\n42\t141\n43\t115\n44\t105\n45\t112\n46\t119\n47\t108\n48\t114\n49\t112\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://node3.cluster.com:8088/proxy/application_1556201346679_0003//jobs"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1556210522160_2095525556","id":"20150210-015302_1492795503","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:21-0700","dateFinished":"2019-04-25T10:28:23-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14122"},{"text":"%sql \nselect age, count(1) value \nfrom bank \nwhere age < ${maxAge=30} \ngroup by age \norder by age","user":"mapr","dateUpdated":"2019-04-25T10:28:27-0700","config":{"colWidth":4,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorHide":false},"settings":{"params":{"maxAge":"35"},"forms":{"maxAge":{"type":"TextBox","name":"maxAge","defaultValue":"30","hidden":false,"$$hashKey":"object:16224"}}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n19\t4\n20\t3\n21\t7\n22\t9\n23\t20\n24\t24\n25\t44\n26\t77\n27\t94\n28\t103\n29\t97\n30\t150\n31\t199\n32\t224\n33\t186\n34\t231\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://node3.cluster.com:8088/proxy/application_1556201346679_0003//jobs"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1556210522160_-1700767013","id":"20150212-145404_867439529","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:23-0700","dateFinished":"2019-04-25T10:28:25-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14123"},{"text":"%sql \nselect age, count(1) value \nfrom bank \nwhere marital=\"${marital=single,single|divorced|married}\" \ngroup by age \norder by age","user":"mapr","dateUpdated":"2019-04-25T10:28:27-0700","config":{"colWidth":4,"editorMode":"ace/mode/sql","results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9,"runOnSelectionChange":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorHide":false},"settings":{"params":{"marital":"single"},"forms":{"marital":{"type":"Select","options":[{"value":"single","$$hashKey":"object:16242"},{"value":"divorced","$$hashKey":"object:16243"},{"value":"married","$$hashKey":"object:16244"}],"name":"marital","defaultValue":"single","hidden":false,"$$hashKey":"object:16233"}}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://node3.cluster.com:8088/proxy/application_1556201346679_0003//jobs"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1556210522161_-482091935","id":"20150213-230422_1600658137","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:25-0700","dateFinished":"2019-04-25T10:28:27-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14124","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tvalue\n19\t4\n20\t3\n21\t7\n22\t9\n23\t17\n24\t13\n25\t33\n26\t56\n27\t64\n28\t78\n29\t56\n30\t92\n31\t86\n32\t105\n33\t61\n34\t75\n35\t46\n36\t50\n37\t43\n38\t44\n39\t30\n40\t25\n41\t19\n42\t23\n43\t21\n44\t20\n45\t15\n46\t14\n47\t12\n48\t12\n49\t11\n50\t8\n51\t6\n52\t9\n53\t4\n55\t3\n56\t3\n57\t2\n58\t7\n59\t2\n60\t5\n66\t2\n69\t1\n"}]}},{"text":"%md\n\nAbout bank data\n\n```\nCitation Request:\n  This dataset is public available for research. The details are described in [Moro et al., 2011]. \n  Please include this citation if you plan to use this database:\n\n  [Moro et al., 2011] S. Moro, R. Laureano and P. Cortez. Using Data Mining for Bank Direct Marketing: An Application of the CRISP-DM Methodology. \n  In P. Novais et al. (Eds.), Proceedings of the European Simulation and Modelling Conference - ESM'2011, pp. 117-121, Guimarães, Portugal, October, 2011. EUROSIS.\n\n  Available at: [pdf] http://hdl.handle.net/1822/14838\n                [bib] http://www3.dsi.uminho.pt/pcortez/bib/2011-esm-1.txt\n```","user":"mapr","dateUpdated":"2019-04-25T10:28:27-0700","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>About bank data</p>\n<pre><code>Citation Request:\n  This dataset is public available for research. The details are described in [Moro et al., 2011]. \n  Please include this citation if you plan to use this database:\n\n  [Moro et al., 2011] S. Moro, R. Laureano and P. Cortez. Using Data Mining for Bank Direct Marketing: An Application of the CRISP-DM Methodology. \n  In P. Novais et al. (Eds.), Proceedings of the European Simulation and Modelling Conference - ESM&#39;2011, pp. 117-121, Guimarães, Portugal, October, 2011. EUROSIS.\n\n  Available at: [pdf] http://hdl.handle.net/1822/14838\n                [bib] http://www3.dsi.uminho.pt/pcortez/bib/2011-esm-1.txt\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1556210522161_-1168241596","id":"20150326-214658_12335843","dateCreated":"2019-04-25T09:42:02-0700","dateStarted":"2019-04-25T10:28:27-0700","dateFinished":"2019-04-25T10:28:27-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14125"},{"user":"mapr","dateUpdated":"2019-04-25T10:24:10-0700","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1556210522161_-921345103","id":"20150703-133047_853701097","dateCreated":"2019-04-25T09:42:02-0700","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14126"}],"name":"Running Spark Jobs in Zeppelin","id":"2E8G1ZNY9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"pig:shared_process":[],"spark:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":true,"looknfeel":"default","personalizedMode":"false"},"info":{}}